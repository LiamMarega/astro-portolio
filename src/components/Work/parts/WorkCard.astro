---
import ButtonMore from "../../ui/buttons/ButtonMore.astro";

interface Props {
  id: string;
  title: string;
  description: string[];
  techStack: TechStack[];
  bgColor: string;
  textColor: string;
  images: Image[];
  reverse?: boolean;
  link?: string;
}

type TechStack = {
  src: string;
  alt: string;
};

type Image = {
  src: string;
  alt: string;
  class: string;
};

const {
  id,
  title,
  description,
  images,
  techStack,
  bgColor,
  textColor,
  reverse = false,
  link,
} = Astro.props;
---

<article
  id={id}
  class={`relative flex ${reverse ? "flex-row-reverse" : "flex-row"} p-5 min-h-screen h-full w-full ${bgColor}`}
  data-work-card
>
  <!-- Project Images - Optimized for Desktop -->
  {
    images.map((image, index) => (
      <img
        src={image.src}
        alt={image.alt}
        loading={index === 0 ? "eager" : "lazy"}
        decoding="async"
        fetchpriority={index === 0 ? "high" : "auto"}
        class={`work-image ${image.class}`}
        width="800"
        height="1600"
      />
    ))
  }

  <!-- Content Container -->
  <div class="w-3/6 h-5/6 flex flex-col justify-center gap-5 p-10 pt-28 z-10">
    <div class="flex flex-col justify-around gap-2">
      <!-- Project Title -->
      <header>
        <h2
          class={`text-4xl mb-10 font-bold w-fit h-fit p-5 rounded-2xl flex justify-center items-center ${textColor} bg-[#E4F4E4] shadow-lg`}
        >
          {title}
        </h2>
      </header>

      <!-- Project Description -->
      <div class="flex flex-col gap-2">
        {
          description.map((desc) => (
            <p class="text-balance text-[#E4F4E4] font-semibold text-xl mb-2 leading-relaxed">
              {desc}
            </p>
          ))
        }
      </div>

      <!-- CTA Button -->
      <ButtonMore link={link} />

      <!-- Tech Stack -->
      <div
        class="flex flex-col mt-4 border-2 rounded-xl border-[#E4F4E4] w-fit self-start hover:shadow-xl transition-shadow duration-300"
      >
        <h3
          class="text-[#E4F4E4] text-xl font-bold w-fit h-fit p-3 flex justify-center items-center border-b-2 border-[#E4F4E4]"
        >
          TECH STACK
        </h3>
        <div class="flex flex-row items-center p-2 gap-x-3">
          {
            techStack.map((tech) => (
              <img
                src={tech.src}
                alt={tech.alt}
                loading="lazy"
                decoding="async"
                class="w-10 h-10 transform transition-all duration-300 hover:scale-110 hover:rotate-3 hover:brightness-110 hover:-translate-y-1"
                width="40"
                height="40"
              />
            ))
          }
        </div>
      </div>
    </div>
  </div>
</article>

<style>
  .work-image {
    -webkit-filter: drop-shadow(-35px 35px 35px #000000);
    filter: drop-shadow(-35px 35px 35px #000000);
    will-change: transform;
  }

  /* Optimize for GSAP animations */
  article[data-work-card] {
    will-change: transform;
  }

  /* Respect reduced motion preference */
  @media (prefers-reduced-motion: reduce) {
    .work-image,
    article[data-work-card] {
      will-change: auto;
    }

    img {
      transition: none !important;
    }
  }
</style>
