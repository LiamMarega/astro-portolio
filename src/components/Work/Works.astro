---
import WorkCard from "../Work/parts/WorkCard.astro";
import WorkCardMobile from "../Work/parts/WorkCardMobile.astro";
import WorkCardTablet from "../Work/parts/WorkCardTablet.astro";
import CircularGallery from "../ui/CircularGallery.astro";
import {
  getProjects,
  shouldReverse,
  techIcons,
  minorProjects,
} from "../../data/projects";
import BentoGrid from "../ui/BentoGrid.astro";
import Iridescense from "../ui/iridescense.astro";

// Get all projects from centralized data source
const projects = getProjects(true); // Sort by featured first
---

<!-- Mobile Version: < 768px -->
<section
  id="work-mobile"
  class="block md:hidden w-full scroll-smooth"
  aria-label="Projects showcase"
>
  {
    projects.map((project, index) => (
      <WorkCardMobile {...project} isReversed={shouldReverse(project, index)} />
    ))
  }
</section>

<!-- Tablet Version: 768px - 1023px -->
<section
  id="work-tablet"
  class="hidden md:block lg:hidden w-full scroll-smooth"
  aria-label="Projects showcase"
>
  {
    projects.map((project, index) => (
      <WorkCardTablet {...project} isReversed={shouldReverse(project, index)} />
    ))
  }
</section>

<!-- Desktop Version: >= 1024px -->
<section
  id="work"
  class="hidden lg:block relative w-full"
  aria-label="Projects showcase"
>
  <div class="work-stack-container p-5">
    {
      projects.map((project, index) => (
        <WorkCard
          {...project}
          cardIndex={index}
          totalCards={projects.length + 1}
          isReversed={shouldReverse(project, index)}
        />
      ))
    }
    <WorkCard
      id="more-works"
      title="The Creative Vault"
      description={[
        "A curated ensemble of professional freelance work, academic breakthroughs, and technical explorations that showcase the depth and versatility of my engineering journey.",
      ]}
      techStack={[techIcons.react, techIcons.typescript]}
      bgColor="bg-[#fde047]"
      textColor="text-[#000000]"
      cardIndex={projects.length}
      totalCards={projects.length + 1}
      isReversed={true}
      useCustomContent
      fullWidthCustomContent
    >
      <Iridescense>
        <BentoGrid />
      </Iridescense>
    </WorkCard>
  </div>

  <style>
    /* Scroll snap for smooth scrolling on mobile/tablet */
    #work-mobile,
    #work-tablet {
      scroll-snap-type: y mandatory;
      overflow-y: auto;
    }

    /* Ensure smooth scrolling */
    @media (prefers-reduced-motion: no-preference) {
      #work-mobile,
      #work-tablet,
      #work {
        scroll-behavior: smooth;
      }
    }

    /* Stacking cards container for desktop */
    .work-stack-container {
      position: relative;
      width: 100%;
    }
  </style>
</section>
