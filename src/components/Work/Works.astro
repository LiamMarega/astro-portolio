---
import WorkCard from "../Work/parts/WorkCard.astro";
import WorkCardMobile from "../Work/parts/WorkCardMobile.astro";
import WorkCardTablet from "../Work/parts/WorkCardTablet.astro";
import CircularGallery from "../ui/CircularGallery.astro";
import {
  getProjects,
  shouldReverse,
  techIcons,
  minorProjects,
} from "../../data/projects";

// Get all projects from centralized data source
const projects = getProjects(true); // Sort by featured first
---

<!-- Mobile Version: < 768px -->
<section
  id="work-mobile"
  class="block md:hidden w-full scroll-smooth"
  aria-label="Projects showcase"
>
  {
    projects.map((project, index) => (
      <WorkCardMobile {...project} isReversed={shouldReverse(project, index)} />
    ))
  }
</section>

<!-- Tablet Version: 768px - 1023px -->
<section
  id="work-tablet"
  class="hidden md:block lg:hidden w-full scroll-smooth"
  aria-label="Projects showcase"
>
  {
    projects.map((project, index) => (
      <WorkCardTablet {...project} isReversed={shouldReverse(project, index)} />
    ))
  }
</section>

<!-- Desktop Version: >= 1024px -->
<section
  id="work"
  class="hidden lg:block relative w-full"
  aria-label="Projects showcase"
>
  <div class="work-stack-container p-5">
    {
      projects.map((project, index) => (
        <WorkCard
          {...project}
          cardIndex={index}
          totalCards={projects.length + 1}
          isReversed={shouldReverse(project, index)}
        />
      ))
    }
    <WorkCard
      id="more-works"
      title="Otros Proyectos"
      description={["Una galería con más trabajos realizados."]}
      techStack={[techIcons.react, techIcons.typescript]}
      bgColor="bg-[#fde047]"
      textColor="text-[#000000]"
      cardIndex={projects.length}
      totalCards={projects.length + 1}
      isReversed={true}
      useCustomContent
      fullWidthCustomContent
    >
      <CircularGallery
        items={minorProjects}
        bend={15}
        textColor="#000000"
        borderRadius={0.05}
        font="bold 24px sans-serif"
        scrollSpeed={1}
        scrollEase={0.05}
        cardHeight={400}
        cardWidth={300}
        cardGap={0.25}
        offsetX={15}
        offsetY={3}
      />
    </WorkCard>
  </div>
</section>

<style>
  /* Scroll snap for smooth scrolling on mobile/tablet */
  #work-mobile,
  #work-tablet {
    scroll-snap-type: y mandatory;
    overflow-y: auto;
  }

  /* Ensure smooth scrolling */
  @media (prefers-reduced-motion: no-preference) {
    #work-mobile,
    #work-tablet,
    #work {
      scroll-behavior: smooth;
    }
  }

  /* Stacking cards container for desktop */
  .work-stack-container {
    position: relative;
    width: 100%;
  }
</style>
